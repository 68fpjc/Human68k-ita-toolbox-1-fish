* crypt.s
* Itagaki Fumihiko 18-Feb-92  Create.

*
* This program is copyright (c) Alec Muffett 1991 except for certain
* portions of code ("crack-fcrypt.c") copyright (c) Robert Baldwin, Icarus
* Sparry and Alec Muffett.  The author(s) disclaims all responsibility or
* liability with respect to it's usage or its effect upon hardware or
* computer systems.  This software is in freely redistributable PROVIDED
* that this notice remains intact.
*

* 19-Feb-92  Itagaki Fumihiko   Porting from C source code to MC68000 assembly

.text

****************************************************************
TF_TO_SIXBIT:
		movem.l	d1-d2,-(a7)
		move.l	d0,d1
		and.l	#@00000077,d1
		move.l	d0,d2
		and.l	#@00007700,d2
		lsl.l	#2,d2
		or.l	d2,d1
		move.l	d0,d2
		and.l	#@00770000,d2
		lsl.l	#4,d2
		or.l	d2,d1
		and.l	#@77000000,d0
		lsl.l	#6,d0
		or.l	d1,d0
		movem.l	(a7)+,d1-d2
		rts
****************************************************************
SIXBIT_TO_TF:
		movem.l	d1-d2,-(a7)
		move.l	d0,d1
		and.l	#$0000003f,d1
		move.l	d0,d2
		and.l	#$00003f00,d2
		lsr.l	#2,d2
		or.l	d2,d1
		move.l	d0,d2
		and.l	#$003f0000,d2
		lsr.l	#4,d2
		or.l	d2,d1
		and.l	#$3f000000,d0
		lsr.l	#6,d0
		or.l	d1,d0
		movem.l	(a7)+,d1-d2
		rts
****************************************************************
* crypt
*
* CALL
*      A0     password (only first 8 letters are recognized)
*      A1     salt (only first 2 letters are recognized)
*      A2     result buffer (16 bytes capacity required)
*
* RETURN
*      none
*
* STACK
*      266 bytes
****************************************************************
.xdef crypt

crypt_block = -66
KS = crypt_block-4*32
sdata = KS-8
pad = sdata-0

crypt:
		link	a6,#pad
		movem.l	d0-d7/a0-a3,-(a7)
		*
		move.b	(a1)+,(a2)+
		move.b	(a1)+,(a2)+
		*
		lea	crypt_block(a6),a1
		moveq	#7,d1
crypt_loop1_1:
		move.b	(a0)+,d0
		bne	crypt_loop1_1c

		subq.l	#1,a0
crypt_loop1_1c:
		lsl.b	#1,d0
		moveq	#7,d2
crypt_loop1_2:
		rol.b	#1,d0
		scs	(a1)+
		dbra	d2,crypt_loop1_2
		dbra	d1,crypt_loop1_1

		clr.b	(a1)+
		clr.b	(a1)+
	*
	* This used to be utterly horrendous. It still is, but it's much, much,
	* smaller... AEM.
	*
		lea	KeyToKS,a0
		lea	KS(a6),a1
		moveq	#31,d1
crypt_loop2_1:
		moveq	#0,d0
		moveq	#0,d2
crypt_loop2_2:
		moveq	#0,d3
		move.b	(a0)+,d3
		move.b	crypt_block(a6,d3.l),d3
		neg.b	d3
		lsl.l	d2,d3
		or.l	d3,d0
		addq.b	#1,d2
		cmp.b	#24,d2
		blo	crypt_loop2_2

		bsr	TF_TO_SIXBIT
		move.l	d0,(a1)+
		dbra	d1,crypt_loop2_1
	*
		moveq	#0,d0
		lea	saltd,a0
		moveq	#0,d1
		move.b	-1(a2),d1
		move.b	(a0,d1.l),d0
		lsl.w	#6,d0
		move.b	-2(a2),d1
		or.b	(a0,d1.l),d0
		bsr	TF_TO_SIXBIT		*  D0.L : saltvalue
	*
		moveq	#0,d1			*  D1:Rl
		moveq	#0,d2			*  D2:Rh
		moveq	#0,d3			*  D3:Ll
		moveq	#0,d4			*  D4:Lh
		moveq	#24,d5
setkey_loop_1:
		lea	KS(a6),a0
		moveq	#7,d6
setkey_loop_2:
	*
	* Oddly enough, direct addressing of dp slows things down, as
	* well as knackering portability - AEM
	*
		movem.l	d5-d6,-(a7)
		bsr	setkeySub
		exg	d1,d3
		exg	d2,d4
		bsr	setkeySub
		exg	d1,d3
		exg	d2,d4
		movem.l	(a7)+,d5-d6
		dbra	d6,setkey_loop_2

		eor.l	d1,d3
		eor.l	d2,d4
		eor.l	d3,d1
		eor.l	d4,d2
		eor.l	d1,d3
		eor.l	d2,d4
		dbra	d5,setkey_loop_1

		exg	d0,d3
		bsr	SIXBIT_TO_TF
		exg	d0,d4
		bsr	SIXBIT_TO_TF
		exg	d0,d1
		bsr	SIXBIT_TO_TF
		exg	d0,d2
		bsr	SIXBIT_TO_TF		*  D0:Rh  D1:Lh  D2:Rl  D4:Ll

		lea	crypt_block(a6),a0
		moveq	#10,d3
		bsr	UnXFormSub
		moveq	#9,d3
		bsr	UnXFormSub
		moveq	#8,d3
		bsr	UnXFormSub
		moveq	#7,d3
		bsr	UnXFormSub
		moveq	#4,d3
		bsr	UnXFormSub
		moveq	#3,d3
		bsr	UnXFormSub
		moveq	#2,d3
		bsr	UnXFormSub
		moveq	#1,d3
		bsr	UnXFormSub
		clr.b	(a0)+
		clr.b	(a0)+

		lea	crypt_block(a6),a0
		lea	final,a1
		moveq	#10,d1
crypt_loop3_1:
		moveq	#0,d0
		moveq	#5,d2
crypt_loop3_2:
		move.b	(a0)+,d3
		lsr.b	d3
		roxl.l	#1,d0
		dbra	d2,crypt_loop3_2

		move.b	(a1,d0.l),(a2)+
		dbra	d1,crypt_loop3_1

		clr.b	(a2)
		tst.b	-12(a2)
		bne	crypt_done

		move.b	-13(a2),-12(a2)
crypt_done:
		movem.l	(a7)+,d0-d7/a0-a3
		unlk	a6
		rts
****************
setkeySub:
		move.l	d1,d5
		eor.l	d2,d5
		and.l	d0,d5

		move.l	d5,d6
		eor.l	d1,d6
		move.l	(a0)+,d7
		eor.l	d7,d6
		lsl.l	#2,d6
		move.l	d6,sdata+4(a6)

		move.l	d5,d6
		eor.l	d2,d6
		move.l	(a0)+,d7
		eor.l	d7,d6
		lsl.l	#2,d6
		move.l	d6,sdata(a6)

		lea	sdata+7(a6),a1
		moveq	#0,d5

		move.b	(a1),d5
		lea	S0H,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d4
		lea	S0L,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d3

		move.b	-(a1),d5
		lea	S1H,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d4
		lea	S1L,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d3

		move.b	-(a1),d5
		lea	S2H,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d4
		lea	S2L,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d3

		move.b	-(a1),d5
		lea	S3H,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d4
		lea	S3L,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d3

		move.b	-(a1),d5
		lea	S4H,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d4
		lea	S4L,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d3

		move.b	-(a1),d5
		lea	S5H,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d4
		lea	S5L,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d3

		move.b	-(a1),d5
		lea	S6H,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d4
		lea	S6L,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d3

		move.b	-(a1),d5
		lea	S7H,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d4
		lea	S7L,a3
		move.l	(a3,d5.l),d7
		eor.l	d7,d3

		rts
****************
UnXFormSub:
		btst	d3,d2
		sne	(a0)+
		btst	d3,d4
		sne	(a0)+
		add.b	#12,d3
		btst	d3,d2
		sne	(a0)+
		btst	d3,d4
		sne	(a0)+
		sub.b	#12,d3

		btst	d3,d0
		sne	(a0)+
		btst	d3,d1
		sne	(a0)+
		add.b	#12,d3
		btst	d3,d0
		sne	(a0)+
		btst	d3,d1
		sne	(a0)+
		rts
****************************************************************
.data

* Try to keep this stuff long aligned - AEM

.even

S0L:
	dc.l	$20022000,$20000000,$00000000,$20022000,$00000000,$20022000,$20000000,$00000000
	dc.l	$20022000,$20022000,$20000000,$00022000,$00022000,$00000000,$00000000,$20000000
	dc.l	$20000000,$00000000,$00022000,$20022000,$20022000,$20000000,$00022000,$00022000
	dc.l	$00000000,$00022000,$20022000,$20000000,$00022000,$00022000,$20000000,$00000000
	dc.l	$00000000,$20022000,$00022000,$20000000,$20022000,$20000000,$00022000,$00022000
	dc.l	$20000000,$00022000,$20022000,$00000000,$20022000,$00000000,$00000000,$20000000
	dc.l	$20022000,$20022000,$20000000,$00022000,$00000000,$00022000,$20000000,$00000000
	dc.l	$20000000,$00000000,$00022000,$20022000,$00000000,$20000000,$00022000,$20022000

S0H:
	dc.l	$00000802,$00000002,$08000800,$08000802,$00000800,$08000002,$08000002,$08000800
	dc.l	$08000002,$00000802,$00000802,$08000000,$08000800,$00000800,$00000000,$08000002
	dc.l	$00000002,$08000000,$00000800,$00000002,$08000802,$00000802,$08000000,$00000800
	dc.l	$08000000,$00000000,$00000002,$08000802,$00000000,$08000800,$08000802,$00000000
	dc.l	$00000000,$08000802,$00000800,$08000002,$00000802,$00000002,$08000000,$00000800
	dc.l	$08000802,$00000000,$00000002,$08000800,$08000002,$08000000,$08000800,$00000802
	dc.l	$08000802,$00000002,$00000802,$08000800,$00000800,$08000000,$08000002,$00000000
	dc.l	$00000002,$00000800,$08000800,$00000802,$08000000,$08000802,$00000000,$08000002

S1L:
	dc.l	$02200004,$00000000,$02200000,$00000000,$00000004,$02200004,$02200000,$02200000
	dc.l	$02200000,$00000004,$00000004,$02200000,$00000004,$02200000,$00000000,$00000004
	dc.l	$00000000,$02200004,$00000004,$02200000,$02200004,$00000000,$00000000,$00000004
	dc.l	$02200004,$02200004,$02200000,$00000004,$00000000,$00000000,$02200004,$02200004
	dc.l	$00000004,$02200000,$02200000,$02200004,$02200004,$00000004,$00000004,$00000000
	dc.l	$00000000,$02200004,$00000000,$00000004,$02200000,$00000000,$02200004,$02200004
	dc.l	$02200000,$02200000,$00000000,$00000004,$00000004,$02200004,$02200000,$00000000
	dc.l	$00000004,$00000000,$02200004,$02200000,$02200004,$00000004,$00000000,$02200000

S1H:
	dc.l	$01100004,$00000000,$00000004,$01100004,$01100000,$00000000,$01100000,$00000004
	dc.l	$00000000,$01100004,$00000000,$01100000,$00000004,$01100004,$01100004,$00000000
	dc.l	$00000004,$01100000,$01100004,$00000000,$00000004,$01100000,$00000000,$00000004
	dc.l	$01100000,$00000004,$01100004,$01100000,$01100000,$00000004,$00000000,$01100004
	dc.l	$00000004,$01100004,$01100000,$00000004,$01100004,$00000004,$01100000,$00000000
	dc.l	$01100000,$00000000,$00000004,$01100004,$00000000,$01100000,$00000004,$01100000
	dc.l	$01100004,$00000000,$00000000,$01100000,$00000000,$01100004,$00000004,$01100004
	dc.l	$01100004,$00000004,$00000000,$01100000,$01100000,$00000000,$01100004,$00000004

S2L:
	dc.l	$00000000,$10000400,$00000400,$00000400,$10000000,$00000000,$00000400,$10000400
	dc.l	$00000400,$10000000,$10000000,$00000000,$10000400,$00000400,$00000000,$10000000
	dc.l	$00000000,$10000000,$10000400,$00000400,$00000400,$10000400,$10000000,$00000000
	dc.l	$10000000,$00000400,$10000400,$10000000,$10000400,$00000000,$00000000,$10000400
	dc.l	$10000400,$00000400,$00000000,$10000000,$00000400,$10000000,$10000000,$00000400
	dc.l	$00000000,$10000400,$10000400,$10000000,$10000000,$00000000,$10000400,$00000000
	dc.l	$10000400,$00000000,$00000000,$10000400,$10000000,$00000400,$00000400,$10000400
	dc.l	$00000400,$00000000,$10000000,$00000400,$00000000,$10000400,$00000400,$10000000

S2H:
	dc.l	$04011000,$00011001,$00000000,$04011000,$04000001,$00011000,$04011000,$00000001
	dc.l	$00011000,$00000001,$00011001,$04000000,$04011001,$04000000,$04000000,$04011001
	dc.l	$00000000,$04000001,$00011001,$00000000,$04000000,$04011001,$00000001,$04011000
	dc.l	$04011001,$00011000,$04000001,$00011001,$00000001,$00000000,$00011000,$04000001
	dc.l	$00011001,$00000000,$04000000,$00000001,$04000000,$04000001,$00011001,$04011000
	dc.l	$00000000,$00011001,$00000001,$04011001,$04000001,$00011000,$04011001,$04000000
	dc.l	$04000001,$04011000,$00011000,$04011001,$00000001,$00011000,$04011000,$00000001
	dc.l	$00011000,$00000000,$04011001,$04000000,$04011000,$04000001,$00000000,$00011001

S3L:
	dc.l	$00040002,$00040000,$00000002,$00040002,$00000000,$00000000,$00040002,$00000002
	dc.l	$00040000,$00000002,$00000000,$00040002,$00000002,$00040002,$00000000,$00000000
	dc.l	$00000002,$00040000,$00040000,$00000002,$00040000,$00040002,$00000000,$00040000
	dc.l	$00040002,$00000000,$00000002,$00040000,$00040000,$00000002,$00040002,$00000000
	dc.l	$00000002,$00040002,$00000000,$00000002,$00040000,$00040000,$00000002,$00000000
	dc.l	$00040002,$00000000,$00040000,$00000002,$00000000,$00000002,$00040000,$00040000
	dc.l	$00000000,$00040002,$00040002,$00000000,$00040002,$00000002,$00040000,$00040002
	dc.l	$00000002,$00040000,$00000000,$00040002,$00040002,$00000000,$00000002,$00040000

S3H:
	dc.l	$20000110,$00040000,$20000000,$20040110,$00000000,$00040110,$20040000,$20000110
	dc.l	$00040110,$20040000,$00040000,$20000000,$20040000,$20000110,$00000110,$00040000
	dc.l	$20040110,$00000110,$00000000,$20000000,$00000110,$20040000,$00040110,$00000000
	dc.l	$20000000,$00000000,$20000110,$00040110,$00040000,$20040110,$20040110,$00000110
	dc.l	$20040110,$20000000,$00000110,$20040000,$00000110,$00040000,$20000000,$00040110
	dc.l	$20040000,$00000000,$00000000,$20000110,$00000000,$20040110,$00040110,$00000000
	dc.l	$00040000,$20040110,$20000110,$00000110,$20040110,$20000000,$00040000,$20000110
	dc.l	$20000110,$00000110,$00040110,$20040000,$20000000,$00040000,$20040000,$00040110

S4L:
	dc.l	$00000000,$04000000,$00011000,$04011008,$04000008,$00011000,$04011008,$04000000
	dc.l	$04000000,$00000008,$00000008,$04011000,$00011008,$04000008,$04011000,$00000000
	dc.l	$04011000,$00000000,$04000008,$00011008,$00011000,$04011008,$00000000,$00000008
	dc.l	$00000008,$00011008,$04011008,$04000008,$04000000,$00011000,$00011008,$04011000
	dc.l	$04011000,$00011008,$04000008,$04000000,$04000000,$00000008,$00000008,$00011000
	dc.l	$00000000,$04011000,$04011008,$00000000,$04011008,$00000000,$00011000,$04000008
	dc.l	$00011008,$00011000,$00000000,$04011008,$04000008,$04011000,$00011008,$04000000
	dc.l	$04011000,$04000008,$00011000,$00011008,$00000008,$04011008,$04000000,$00000008

S4H:
	dc.l	$00022000,$00000000,$00000000,$00022000,$00022000,$00022000,$00000000,$00022000
	dc.l	$00000000,$00000000,$00022000,$00000000,$00022000,$00022000,$00022000,$00000000
	dc.l	$00000000,$00022000,$00000000,$00000000,$00022000,$00000000,$00000000,$00022000
	dc.l	$00000000,$00022000,$00022000,$00000000,$00022000,$00000000,$00000000,$00022000
	dc.l	$00022000,$00022000,$00000000,$00022000,$00000000,$00000000,$00022000,$00022000
	dc.l	$00022000,$00000000,$00022000,$00000000,$00000000,$00022000,$00000000,$00000000
	dc.l	$00022000,$00000000,$00000000,$00022000,$00022000,$00022000,$00000000,$00000000
	dc.l	$00000000,$00022000,$00022000,$00000000,$00000000,$00000000,$00022000,$00022000

S5L:
	dc.l	$00000110,$00000110,$00000000,$00080000,$00000110,$00080000,$00080110,$00000000
	dc.l	$00080110,$00080110,$00080000,$00000000,$00080000,$00000110,$00000000,$00080110
	dc.l	$00000000,$00080110,$00000110,$00000000,$00080000,$00000110,$00080000,$00000110
	dc.l	$00080110,$00000000,$00000000,$00080110,$00000110,$00080000,$00080110,$00080000
	dc.l	$00080110,$00000000,$00080000,$00080110,$00080000,$00000110,$00000000,$00080000
	dc.l	$00000000,$00080000,$00000110,$00000000,$00000110,$00080110,$00080000,$00000110
	dc.l	$00080110,$00080000,$00000000,$00080110,$00000110,$00000000,$00080110,$00000000
	dc.l	$00080000,$00000110,$00080110,$00080000,$00000000,$00080110,$00000110,$00000110

S5H:
	dc.l	$02200000,$00000008,$00000000,$02200008,$00000008,$00000000,$02200000,$00000008
	dc.l	$00000000,$02200008,$00000008,$02200000,$02200000,$02200000,$02200008,$00000008
	dc.l	$00000008,$02200000,$02200008,$00000000,$00000000,$00000000,$02200008,$02200008
	dc.l	$02200008,$02200008,$02200000,$00000000,$00000000,$00000008,$00000008,$02200000
	dc.l	$00000000,$02200000,$02200000,$00000008,$02200008,$00000008,$00000000,$02200000
	dc.l	$02200000,$00000000,$02200008,$00000008,$00000008,$02200008,$00000008,$00000000
	dc.l	$02200008,$00000008,$00000008,$02200000,$02200000,$02200008,$00000008,$00000000
	dc.l	$00000000,$02200000,$02200000,$02200008,$02200008,$00000000,$00000000,$02200008

S6L:
	dc.l	$01100000,$00000800,$00000800,$00000001,$01100801,$01100001,$01100800,$00000000
	dc.l	$00000000,$00000801,$00000801,$01100000,$00000001,$01100800,$01100000,$00000801
	dc.l	$00000801,$01100000,$01100001,$01100801,$00000000,$00000800,$00000001,$01100800
	dc.l	$01100001,$01100801,$01100800,$00000001,$01100801,$01100001,$00000800,$00000000
	dc.l	$01100801,$01100000,$01100001,$00000801,$01100000,$00000800,$00000000,$01100001
	dc.l	$00000801,$01100801,$01100800,$00000000,$00000800,$00000001,$00000001,$00000800
	dc.l	$00000000,$00000801,$00000800,$01100800,$00000801,$01100000,$01100801,$00000000
	dc.l	$01100800,$00000001,$01100001,$01100801,$00000001,$01100800,$01100000,$01100001

S6H:
	dc.l	$00000000,$00000000,$00000400,$10000400,$10000400,$10000000,$00000000,$00000000
	dc.l	$00000400,$10000400,$10000000,$00000400,$10000000,$00000400,$00000400,$10000000
	dc.l	$10000400,$00000000,$10000000,$10000400,$00000000,$00000400,$10000400,$00000000
	dc.l	$10000400,$10000000,$00000400,$10000000,$10000000,$10000400,$00000000,$00000400
	dc.l	$10000000,$00000400,$10000400,$10000000,$00000000,$00000000,$00000400,$10000400
	dc.l	$10000400,$10000000,$00000000,$00000000,$00000000,$10000400,$10000000,$00000400
	dc.l	$00000000,$10000400,$00000400,$00000000,$10000000,$00000000,$10000400,$00000400
	dc.l	$00000400,$10000000,$10000000,$10000400,$10000400,$00000400,$00000400,$10000000

S7L:
	dc.l	$00000220,$08000000,$08000220,$00000000,$08000000,$00000220,$00000000,$08000220
	dc.l	$00000220,$00000000,$08000000,$08000220,$08000220,$08000220,$00000220,$00000000
	dc.l	$08000000,$08000220,$00000220,$08000000,$08000220,$00000220,$00000000,$08000000
	dc.l	$00000000,$00000000,$08000220,$00000220,$00000000,$08000000,$08000000,$00000220
	dc.l	$00000000,$08000000,$00000220,$08000220,$08000220,$00000000,$00000000,$08000000
	dc.l	$00000220,$08000220,$08000000,$00000220,$08000000,$00000220,$00000220,$08000000
	dc.l	$08000220,$00000000,$00000000,$00000220,$08000000,$08000220,$08000220,$00000000
	dc.l	$00000220,$08000000,$08000220,$00000000,$00000000,$00000220,$08000000,$08000220

S7H:
	dc.l	$00080220,$00080220,$00000000,$00000000,$00080000,$00000220,$00080220,$00080220
	dc.l	$00000000,$00080000,$00000220,$00000000,$00000220,$00080000,$00080000,$00080220
	dc.l	$00000000,$00000220,$00000220,$00080000,$00080220,$00080000,$00000000,$00000220
	dc.l	$00080000,$00000220,$00080000,$00080220,$00000220,$00000000,$00080220,$00000000
	dc.l	$00000220,$00000000,$00080000,$00080220,$00000000,$00080000,$00000000,$00000220
	dc.l	$00080220,$00080000,$00080000,$00000220,$00080220,$00000000,$00000220,$00080000
	dc.l	$00080220,$00000220,$00080220,$00080000,$00000220,$00000000,$00080000,$00080220
	dc.l	$00000000,$00080220,$00000220,$00000000,$00080000,$00080220,$00000000,$00000220

KeyToKS:
	dc.b	9,50,33,59,48,16,32,56,1,8,18,41,2,34,25,24
	dc.b	43,57,58,0,35,26,17,40,21,27,38,53,36,3,46,29
	dc.b	4,52,22,28,60,20,37,62,14,19,44,13,12,61,54,30
	dc.b	1,42,25,51,40,8,24,48,58,0,10,33,59,26,17,16
	dc.b	35,49,50,57,56,18,9,32,13,19,30,45,28,62,38,21
	dc.b	27,44,14,20,52,12,29,54,6,11,36,5,4,53,46,22
	dc.b	50,26,9,35,24,57,8,32,42,49,59,17,43,10,1,0
	dc.b	48,33,34,41,40,2,58,16,60,3,14,29,12,46,22,5
	dc.b	11,28,61,4,36,27,13,38,53,62,20,52,19,37,30,6
	dc.b	34,10,58,48,8,41,57,16,26,33,43,1,56,59,50,49
	dc.b	32,17,18,25,24,51,42,0,44,54,61,13,27,30,6,52
	dc.b	62,12,45,19,20,11,60,22,37,46,4,36,3,21,14,53
	dc.b	18,59,42,32,57,25,41,0,10,17,56,50,40,43,34,33
	dc.b	16,1,2,9,8,35,26,49,28,38,45,60,11,14,53,36
	dc.b	46,27,29,3,4,62,44,6,21,30,19,20,54,5,61,37
	dc.b	2,43,26,16,41,9,25,49,59,1,40,34,24,56,18,17
	dc.b	0,50,51,58,57,48,10,33,12,22,29,44,62,61,37,20
	dc.b	30,11,13,54,19,46,28,53,5,14,3,4,38,52,45,21
	dc.b	51,56,10,0,25,58,9,33,43,50,24,18,8,40,2,1
	dc.b	49,34,35,42,41,32,59,17,27,6,13,28,46,45,21,4
	dc.b	14,62,60,38,3,30,12,37,52,61,54,19,22,36,29,5
	dc.b	35,40,59,49,9,42,58,17,56,34,8,2,57,24,51,50
	dc.b	33,18,48,26,25,16,43,1,11,53,60,12,30,29,5,19
	dc.b	61,46,44,22,54,14,27,21,36,45,38,3,6,20,13,52
	dc.b	56,32,51,41,1,34,50,9,48,26,0,59,49,16,43,42
	dc.b	25,10,40,18,17,8,35,58,3,45,52,4,22,21,60,11
	dc.b	53,38,36,14,46,6,19,13,28,37,30,62,61,12,5,44
	dc.b	40,16,35,25,50,18,34,58,32,10,49,43,33,0,56,26
	dc.b	9,59,24,2,1,57,48,42,54,29,36,19,6,5,44,62
	dc.b	37,22,20,61,30,53,3,60,12,21,14,46,45,27,52,28
	dc.b	24,0,48,9,34,2,18,42,16,59,33,56,17,49,40,10
	dc.b	58,43,8,51,50,41,32,26,38,13,20,3,53,52,28,46
	dc.b	21,6,4,45,14,37,54,44,27,5,61,30,29,11,36,12
	dc.b	8,49,32,58,18,51,2,26,0,43,17,40,1,33,24,59
	dc.b	42,56,57,35,34,25,16,10,22,60,4,54,37,36,12,30
	dc.b	5,53,19,29,61,21,38,28,11,52,45,14,13,62,20,27
	dc.b	57,33,16,42,2,35,51,10,49,56,1,24,50,17,8,43
	dc.b	26,40,41,48,18,9,0,59,6,44,19,38,21,20,27,14
	dc.b	52,37,3,13,45,5,22,12,62,36,29,61,60,46,4,11
	dc.b	41,17,0,26,51,48,35,59,33,40,50,8,34,1,57,56
	dc.b	10,24,25,32,2,58,49,43,53,28,3,22,5,4,11,61
	dc.b	36,21,54,60,29,52,6,27,46,20,13,45,44,30,19,62
	dc.b	25,1,49,10,35,32,48,43,17,24,34,57,18,50,41,40
	dc.b	59,8,9,16,51,42,33,56,37,12,54,6,52,19,62,45
	dc.b	20,5,38,44,13,36,53,11,30,4,60,29,28,14,3,46
	dc.b	17,58,41,2,56,24,40,35,9,16,26,49,10,42,33,32
	dc.b	51,0,1,8,43,34,25,48,29,4,46,61,44,11,54,37
	dc.b	12,60,30,36,5,28,45,3,22,27,52,21,20,6,62,38

* Table lookups for salts reduce crypt overhead dramatically
saltd:
	dc.b	18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33
	dc.b	34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49
	dc.b	50,51,52,53,54,55,56,57,58,59,60,61,62,63,0,1
	dc.b	2,3,4,5,6,7,8,9,10,11,5,6,7,8,9,10
	dc.b	11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26
	dc.b	27,28,29,30,31,32,33,34,35,36,37,32,33,34,35,36
	dc.b	37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52
	dc.b	53,54,55,56,57,58,59,60,61,62,63,0,1,2,3,4
	dc.b	5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20
	dc.b	21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36
	dc.b	37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52
	dc.b	53,54,55,56,57,58,59,60,61,62,63,0,1,2,3,4
	dc.b	5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20
	dc.b	21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36
	dc.b	37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52
	dc.b	53,54,55,56,57,58,59,60,61,62,63,0,1,2,3,4

* final perutation desalting
final:
	dc.b	'./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'
****************************************************************
.end
