-------------------------------------------------------------------
■ login.x とは


     login.x は，UNIX の /bin/login のような働きをするプログラム
     です．具体的には次の動作をします．


          1  端末に対してユーザのログイン名を問い合わせる．

          2  端末に対してユーザのパスワードを問い合わせる．

          3  ファイル A:/etc/passwd を参照し，パスワードが
             一致しなければ 1 へ．

          4  ファイル A:/etc/passwd からユーザのログイン名
             を得，それを環境変数 LOGNAME および USER にセッ
             トする．

          5  ファイル A:/etc/passwd からユーザのホーム・ディ
             レクトリを得，それを環境変数 HOME にセットし，
             カレント・ディレクトリをそこに移動する．

          6  ファイル A:/etc/passwd からユーザのシェルのパ
             ス名を得，それを環境変数 SHELL にセットし，そ
             れを exec する．ここで言う exec とは Human68k
             の DOSファンクションの exec であり，login.x は
             シェルの終了を待っている．シェルが終了して
             login.x に戻って来たら，再び 1 へ．


     が，今回配布する login.x は未完成であり，次の動作をするのみ
     です．


          1  端末に対してユーザのログイン名を問い合わせる．

          2  端末に対してユーザのパスワードを問い合わせる．

          3  A:/bin/fish.x を exec する．シェルが終了して
             login.x に戻って来たら，再び 1 へ．


-------------------------------------------------------------------
■ 何のために使うか


     login.x を使う目的は 2つあります．


     1  FISH をログイン・シェルとして動作させる

        FISH は，login.x から起動されると自動的にログイン・
        シェルとなります．CONFIG.SYS に SHELL=A:\bin\fish.x
        のように記述したり，Human68k のプロンプト # に対し
        て A:\bin\fish のように入力することによって
        Human68k から直接起動された場合にも FISH はログイン・
        シェルとなりますが，この場合，FISH を終了すると
        Human68k のプロンプト # に戻ってしまい，不便です．


     2  Human68k を利用する環境をユーザ毎に振り分ける

        ファイル A:/etc/passwd によって，ユーザ毎に環境を振
        り分け，また，非ユーザの利用を排除します．

        ただし，今回配布する login.x には，この働きはまだあ
        りません．


-------------------------------------------------------------------
■ 一般的な使い方


     CONFIG.SYS に，

          SHELL=A:\bin\login.x

     と記述し，Human68k 起動時に login.x が自動的に起動されるよう
     にしておきます．

     さらに，現在の login.x は USER や HOME などの環境変数のセッ
     トを行いませんので，応急的に

          ENVSET=512 A:\etc\Environ

     とでもしておいて，A:\etc\Environ に

          HOME=A:\home\ita
          LOGNAME=ita
          SHELL=A:\bin\fish.x
          USER=ita
          temp=D:\

     のように書いておくと良いでしょう．


     なお，login.x は決して終了しませんので注意して下さい．


-------------------------------------------------------------------
■ 予告


     login.x の作成を進める同時に，getty.x も作成するつもりです．
     これは，端末をオープンして子プロセス（一般的には login.x）に
     渡すプログラムです．

     端末を CON とすれば通常通り FISH あるいは他のシェルを使用す
     ることができますし，AUX とすれば RS232-C で X68000 に接続さ
     れている端末上で FISH を使用することができるようになるでしょ
     う．デバイス・ドライバさえ用意すれば，その他の端末からの利用
     も可能となります．

     Human68k はシングル・タスク／シングル・ユーザのＯＳですから，
     getty.x の機能は login.x に内蔵してもいいかも知れません．こ
     のあたりは検討の必要があります．


-------------------------------------------------------------------
